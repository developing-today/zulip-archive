[
    {
        "content": "<p>variety of things to work on soon</p>",
        "id": 464972755,
        "sender_full_name": "dezren39",
        "timestamp": 1724578772
    },
    {
        "content": "<p><a href=\"#narrow/stream/452156-general/topic/todo/near/464972755\">A message</a> was moved here from <a class=\"stream-topic\" data-stream-id=\"452156\" href=\"/#narrow/stream/452156-general/topic/.28no.20topic.29\">#general &gt; (no topic)</a> by <span class=\"user-mention silent\" data-user-id=\"748736\">dezren39</span>.</p>",
        "id": 464974967,
        "sender_full_name": "Notification Bot",
        "timestamp": 1724579532
    },
    {
        "content": "<p><a href=\"https://roc.zulipchat.com/#narrow/stream/316715-contributing/topic/Request.20for.20Assistance.20-.20nixOS.20roc-ray/near/502090070\">https://roc.zulipchat.com/#narrow/stream/316715-contributing/topic/Request.20for.20Assistance.20-.20nixOS.20roc-ray/near/502090070</a></p>\n<p>I finally got to this @<strong>Luke Boswell</strong>, this flake.nix makes <code>just dev examples/pong.roc</code> work :)</p>\n<div class=\"codehilite\" data-code-language=\"Nix\"><pre><span></span><code><span class=\"p\">{</span>\n  <span class=\"ss\">description</span> <span class=\"o\">=</span> <span class=\"s2\">\"Roc Ray platform flake\"</span><span class=\"p\">;</span>\n\n  <span class=\"ss\">inputs</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n    roc<span class=\"o\">.</span><span class=\"ss\">url</span> <span class=\"o\">=</span> <span class=\"s2\">\"github:roc-lang/roc\"</span><span class=\"p\">;</span>\n\n    nixpkgs<span class=\"o\">.</span><span class=\"ss\">follows</span> <span class=\"o\">=</span> <span class=\"s2\">\"roc/nixpkgs\"</span><span class=\"p\">;</span>\n\n    <span class=\"c1\"># rust from nixpkgs has some libc problems, this is patched in the rust-overlay</span>\n    <span class=\"ss\">rust-overlay</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n        <span class=\"ss\">url</span> <span class=\"o\">=</span> <span class=\"s2\">\"github:oxalica/rust-overlay\"</span><span class=\"p\">;</span>\n        inputs<span class=\"o\">.</span>nixpkgs<span class=\"o\">.</span><span class=\"ss\">follows</span> <span class=\"o\">=</span> <span class=\"s2\">\"nixpkgs\"</span><span class=\"p\">;</span>\n    <span class=\"p\">};</span>\n\n    <span class=\"c1\"># to easily make configs for multiple architectures</span>\n    flake-utils<span class=\"o\">.</span><span class=\"ss\">url</span> <span class=\"o\">=</span> <span class=\"s2\">\"github:numtide/flake-utils\"</span><span class=\"p\">;</span>\n\n    <span class=\"c1\"># to make graphics work with nix</span>\n    <span class=\"ss\">nixgl</span> <span class=\"o\">=</span> <span class=\"p\">{</span>\n      <span class=\"ss\">url</span> <span class=\"o\">=</span> <span class=\"s2\">\"github:guibou/nixGL\"</span><span class=\"p\">;</span>\n      inputs<span class=\"o\">.</span>nixpkgs<span class=\"o\">.</span><span class=\"ss\">follows</span> <span class=\"o\">=</span> <span class=\"s2\">\"nixpkgs\"</span><span class=\"p\">;</span>\n      inputs<span class=\"o\">.</span>flake-utils<span class=\"o\">.</span><span class=\"ss\">follows</span> <span class=\"o\">=</span> <span class=\"s2\">\"flake-utils\"</span><span class=\"p\">;</span>\n    <span class=\"p\">};</span>\n\n  <span class=\"p\">};</span>\n\n  <span class=\"ss\">outputs</span> <span class=\"o\">=</span> <span class=\"p\">{</span> self<span class=\"p\">,</span> roc<span class=\"p\">,</span> nixpkgs<span class=\"p\">,</span> rust-overlay<span class=\"p\">,</span> flake-utils<span class=\"p\">,</span> nixgl  <span class=\"p\">}:</span>\n    <span class=\"k\">let</span> <span class=\"ss\">supportedSystems</span> <span class=\"o\">=</span> <span class=\"p\">[</span> <span class=\"s2\">\"x86_64-linux\"</span> <span class=\"s2\">\"aarch64-linux\"</span> <span class=\"s2\">\"x86_64-darwin\"</span> <span class=\"s2\">\"aarch64-darwin\"</span> <span class=\"p\">];</span>\n    <span class=\"k\">in</span> flake-utils<span class=\"o\">.</span>lib<span class=\"o\">.</span>eachSystem supportedSystems <span class=\"p\">(</span>system<span class=\"p\">:</span>\n        <span class=\"k\">let</span>\n            <span class=\"ss\">overlays</span> <span class=\"o\">=</span> <span class=\"p\">[</span> <span class=\"p\">(</span><span class=\"nb\">import</span> rust-overlay<span class=\"p\">)</span> <span class=\"p\">]</span>\n              <span class=\"o\">++</span> <span class=\"p\">(</span><span class=\"k\">if</span> <span class=\"ss\">system</span> <span class=\"o\">==</span> <span class=\"s2\">\"x86_64-linux\"</span> <span class=\"k\">then</span> <span class=\"p\">[</span> nixgl<span class=\"o\">.</span>overlay <span class=\"p\">]</span> <span class=\"k\">else</span> <span class=\"p\">[</span> <span class=\"p\">]);</span>\n\n            <span class=\"ss\">pkgs</span> <span class=\"o\">=</span> <span class=\"nb\">import</span> nixpkgs <span class=\"p\">{</span> <span class=\"k\">inherit</span> system overlays<span class=\"p\">;</span> <span class=\"p\">};</span>\n\n            <span class=\"ss\">rocPkgs</span> <span class=\"o\">=</span> roc<span class=\"o\">.</span>packages<span class=\"o\">.</span><span class=\"si\">${</span>system<span class=\"si\">}</span><span class=\"p\">;</span>\n            <span class=\"c1\"># llvmPkgs = pkgs.llvmPackages_16;</span>\n\n            <span class=\"ss\">rust</span> <span class=\"o\">=</span> pkgs<span class=\"o\">.</span>rust-bin<span class=\"o\">.</span>fromRustupToolchainFile <span class=\"s2\">\"</span><span class=\"si\">${</span><span class=\"nb\">toString</span> <span class=\"l\">./rust-toolchain.toml</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">;</span>\n\n            <span class=\"ss\">linuxDeps</span> <span class=\"o\">=</span> <span class=\"k\">with</span> pkgs<span class=\"p\">;</span>\n                lib<span class=\"o\">.</span>optionals stdenv<span class=\"o\">.</span>isLinux <span class=\"p\">[</span>\n                    libglvnd\n                    xorg<span class=\"o\">.</span>libX11\n                    xorg<span class=\"o\">.</span>libXcursor\n                    xorg<span class=\"o\">.</span>libXrandr\n                    xorg<span class=\"o\">.</span>libXi\n                    xorg<span class=\"o\">.</span>libxcb\n                    xorg<span class=\"o\">.</span>libXinerama\n                <span class=\"p\">];</span>\n\n            <span class=\"ss\">macosDeps</span> <span class=\"o\">=</span> <span class=\"k\">if</span> pkgs<span class=\"o\">.</span>stdenv<span class=\"o\">.</span>isDarwin <span class=\"k\">then</span> <span class=\"p\">[</span>\n                pkgs<span class=\"o\">.</span>libiconv\n                pkgs<span class=\"o\">.</span>darwin<span class=\"o\">.</span>apple_sdk<span class=\"o\">.</span>frameworks<span class=\"o\">.</span>SystemConfiguration\n                pkgs<span class=\"o\">.</span>darwin<span class=\"o\">.</span>apple_sdk<span class=\"o\">.</span>frameworks<span class=\"o\">.</span>CoreGraphics\n                pkgs<span class=\"o\">.</span>darwin<span class=\"o\">.</span>apple_sdk<span class=\"o\">.</span>frameworks<span class=\"o\">.</span>AppKit\n            <span class=\"p\">]</span> <span class=\"k\">else</span> <span class=\"p\">[];</span>\n\n        <span class=\"k\">in</span> <span class=\"p\">{</span>\n\n            <span class=\"ss\">devShell</span> <span class=\"o\">=</span> <span class=\"k\">if</span> pkgs<span class=\"o\">.</span>stdenv<span class=\"o\">.</span>isDarwin <span class=\"k\">then</span>\n                <span class=\"nb\">throw</span> <span class=\"s s-Multiline\">''</span>\n<span class=\"s s-Multiline\">                    HELP WANTED FOR ROC RAY NIX CONFIGURATION</span>\n\n<span class=\"s s-Multiline\">                    Darwin/macOS is not currently supported due to framework linking issues.</span>\n<span class=\"s s-Multiline\">                    If you'd like to help fix this, please check:</span>\n<span class=\"s s-Multiline\">                    https://github.com/your-repo/roc-ray/issues</span>\n\n<span class=\"s s-Multiline\">                    The main issue is with linking Objective-C runtime and macOS frameworks</span>\n<span class=\"s s-Multiline\">                    correctly within the Nix environment. I can't find the right incantation</span>\n<span class=\"s s-Multiline\">                    to make it work. If you have experience with this, please help! :smile:</span>\n<span class=\"s s-Multiline\">                ''</span>\n                <span class=\"k\">else</span> pkgs<span class=\"o\">.</span>mkShell <span class=\"p\">{</span>\n\n                <span class=\"ss\">packages</span> <span class=\"o\">=</span> <span class=\"p\">[</span>\n                        rocPkgs<span class=\"o\">.</span>cli\n                        rust\n                        pkgs<span class=\"o\">.</span>zig <span class=\"c1\"># For Web support, used to build roc wasm static library</span>\n                        pkgs<span class=\"o\">.</span>emscripten\n                        pkgs<span class=\"o\">.</span>simple-http-server\n                        pkgs<span class=\"o\">.</span>just <span class=\"c1\"># For dev command</span>\n                    <span class=\"p\">]</span> <span class=\"o\">++</span> linuxDeps <span class=\"o\">++</span> macosDeps<span class=\"p\">;</span>\n\n                <span class=\"ss\">shellHook</span> <span class=\"o\">=</span> <span class=\"s s-Multiline\">''</span>\n<span class=\"s s-Multiline\">                    if [ \"$(uname)\" = \"Darwin\" ]; then</span>\n<span class=\"s s-Multiline\">                        export SDKROOT=$(xcrun --show-sdk-path)</span>\n<span class=\"s s-Multiline\">                        export LD_LIBRARY_PATH=</span><span class=\"si\">${</span>pkgs<span class=\"o\">.</span>lib<span class=\"o\">.</span>makeLibraryPath macosDeps<span class=\"si\">}</span><span class=\"s s-Multiline\">:$LD_LIBRARY_PATH</span>\n<span class=\"s s-Multiline\">                    fi</span>\n\n<span class=\"s s-Multiline\">                    if [ \"$(uname)\" = \"Linux\" ]; then</span>\n<span class=\"s s-Multiline\">                        export LD_LIBRARY_PATH=</span><span class=\"si\">${</span>pkgs<span class=\"o\">.</span>lib<span class=\"o\">.</span>makeLibraryPath linuxDeps<span class=\"si\">}</span><span class=\"s s-Multiline\">:$LD_LIBRARY_PATH</span>\n<span class=\"s s-Multiline\">                    fi</span>\n<span class=\"s s-Multiline\">                ''</span><span class=\"p\">;</span>\n            <span class=\"p\">};</span>\n\n            <span class=\"ss\">formatter</span> <span class=\"o\">=</span> pkgs<span class=\"o\">.</span>nixpkgs-fmt<span class=\"p\">;</span>\n\n        <span class=\"p\">});</span>\n<span class=\"p\">}</span>\n</code></pre></div>\n<div class=\"message_embed\"><a class=\"message_embed_image\" href=\"https://roc.zulipchat.com/#narrow/stream/316715-contributing/topic/Request.20for.20Assistance.20-.20nixOS.20roc-ray/near/502090070\" style=\"background-image: url(&quot;https://uploads.zulipusercontent.net/2d74836ce3f80a868a57630a6443758083008aad/68747470733a2f2f617661746172732e7a756c69702e636f6d2f32323030382f7265616c6d2f69636f6e2e706e673f76657273696f6e3d32&quot;)\"></a><div class=\"data-container\"><div class=\"message_embed_title\"><a href=\"https://roc.zulipchat.com/#narrow/stream/316715-contributing/topic/Request.20for.20Assistance.20-.20nixOS.20roc-ray/near/502090070\" title=\"Public view of Roc | Zulip team chat\">Public view of Roc | Zulip team chat</a></div><div class=\"message_embed_description\">Browse the publicly accessible channels in Roc without logging in.</div></div></div>",
        "id": 527996279,
        "sender_full_name": "dezren39",
        "timestamp": 1752119256
    }
]